import{c as P}from"./vendor-BCeIfVQQ.js";import{k as ct}from"./sha3-CHwt7_Cm.js";const ut=()=>"9.1.0",ft=e=>e.toString(16).padStart(2,"0"),dt=e=>{const t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t,ft).join("")},lt=()=>typeof window<"u"?dt(10):new Date().getTime().toString(36);class Z{}Z.makeRequest=(e,t)=>({id:lt(),method:e,params:t,env:{sdkVersion:ut()}});Z.makeResponse=(e,t,n)=>({id:e,success:!0,version:n,data:t});Z.makeErrorResponse=(e,t,n)=>({id:e,success:!1,error:t,version:n});var A;(function(e){e.sendTransactions="sendTransactions",e.rpcCall="rpcCall",e.getChainInfo="getChainInfo",e.getSafeInfo="getSafeInfo",e.getTxBySafeTxHash="getTxBySafeTxHash",e.getSafeBalances="getSafeBalances",e.signMessage="signMessage",e.signTypedMessage="signTypedMessage",e.getEnvironmentInfo="getEnvironmentInfo",e.getOffChainSignature="getOffChainSignature",e.requestAddressBook="requestAddressBook",e.wallet_getPermissions="wallet_getPermissions",e.wallet_requestPermissions="wallet_requestPermissions"})(A||(A={}));var de;(function(e){e.requestAddressBook="requestAddressBook"})(de||(de={}));class ht{constructor(t=null,n=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:r,data:s,source:i})=>{const c=!s,u=!this.isServer&&i===window.parent,g=typeof s.version<"u"&&parseInt(s.version.split(".")[0]),E=typeof g=="number"&&g>=1;let m=!0;return Array.isArray(this.allowedOrigins)&&(m=this.allowedOrigins.find(y=>y.test(r))!==void 0),!c&&u&&E&&m},this.logIncomingMessage=r=>{console.info(`Safe Apps SDK v1: A message was received from origin ${r.origin}. `,r.data)},this.onParentMessage=r=>{this.isValidMessage(r)&&(this.debugMode&&this.logIncomingMessage(r),this.handleIncomingMessage(r.data))},this.handleIncomingMessage=r=>{const{id:s}=r,i=this.callbacks.get(s);i&&(i(r),this.callbacks.delete(s))},this.send=(r,s)=>{const i=Z.makeRequest(r,s);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(i,"*"),new Promise((c,u)=>{this.callbacks.set(i.id,g=>{if(!g.success){u(new Error(g.error));return}c(g)})})},this.allowedOrigins=t,this.debugMode=n,this.isServer||window.addEventListener("message",this.onParentMessage)}}const Ne=e=>typeof e=="object"&&e!=null&&"domain"in e&&"types"in e&&"message"in e;var gt={},U={},D={},le={exports:{}};(function(e,t){var n=typeof self<"u"?self:P,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(c){var u={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function g(o){return o&&DataView.prototype.isPrototypeOf(o)}if(u.arrayBuffer)var E=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(o){return o&&E.indexOf(Object.prototype.toString.call(o))>-1};function y(o){if(typeof o!="string"&&(o=String(o)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(o))throw new TypeError("Invalid character in header field name");return o.toLowerCase()}function $(o){return typeof o!="string"&&(o=String(o)),o}function C(o){var a={next:function(){var f=o.shift();return{done:f===void 0,value:f}}};return u.iterable&&(a[Symbol.iterator]=function(){return a}),a}function p(o){this.map={},o instanceof p?o.forEach(function(a,f){this.append(f,a)},this):Array.isArray(o)?o.forEach(function(a){this.append(a[0],a[1])},this):o&&Object.getOwnPropertyNames(o).forEach(function(a){this.append(a,o[a])},this)}p.prototype.append=function(o,a){o=y(o),a=$(a);var f=this.map[o];this.map[o]=f?f+", "+a:a},p.prototype.delete=function(o){delete this.map[y(o)]},p.prototype.get=function(o){return o=y(o),this.has(o)?this.map[o]:null},p.prototype.has=function(o){return this.map.hasOwnProperty(y(o))},p.prototype.set=function(o,a){this.map[y(o)]=$(a)},p.prototype.forEach=function(o,a){for(var f in this.map)this.map.hasOwnProperty(f)&&o.call(a,this.map[f],f,this)},p.prototype.keys=function(){var o=[];return this.forEach(function(a,f){o.push(f)}),C(o)},p.prototype.values=function(){var o=[];return this.forEach(function(a){o.push(a)}),C(o)},p.prototype.entries=function(){var o=[];return this.forEach(function(a,f){o.push([f,a])}),C(o)},u.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function L(o){if(o.bodyUsed)return Promise.reject(new TypeError("Already read"));o.bodyUsed=!0}function S(o){return new Promise(function(a,f){o.onload=function(){a(o.result)},o.onerror=function(){f(o.error)}})}function j(o){var a=new FileReader,f=S(a);return a.readAsArrayBuffer(o),f}function te(o){var a=new FileReader,f=S(a);return a.readAsText(o),f}function ne(o){for(var a=new Uint8Array(o),f=new Array(a.length),d=0;d<a.length;d++)f[d]=String.fromCharCode(a[d]);return f.join("")}function X(o){if(o.slice)return o.slice(0);var a=new Uint8Array(o.byteLength);return a.set(new Uint8Array(o)),a.buffer}function Q(){return this.bodyUsed=!1,this._initBody=function(o){this._bodyInit=o,o?typeof o=="string"?this._bodyText=o:u.blob&&Blob.prototype.isPrototypeOf(o)?this._bodyBlob=o:u.formData&&FormData.prototype.isPrototypeOf(o)?this._bodyFormData=o:u.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)?this._bodyText=o.toString():u.arrayBuffer&&u.blob&&g(o)?(this._bodyArrayBuffer=X(o.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(o)||m(o))?this._bodyArrayBuffer=X(o):this._bodyText=o=Object.prototype.toString.call(o):this._bodyText="",this.headers.get("content-type")||(typeof o=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):u.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u.blob&&(this.blob=function(){var o=L(this);if(o)return o;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?L(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(j)}),this.text=function(){var o=L(this);if(o)return o;if(this._bodyBlob)return te(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ne(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},u.formData&&(this.formData=function(){return this.text().then(ie)}),this.json=function(){return this.text().then(JSON.parse)},this}var re=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function se(o){var a=o.toUpperCase();return re.indexOf(a)>-1?a:o}function O(o,a){a=a||{};var f=a.body;if(o instanceof O){if(o.bodyUsed)throw new TypeError("Already read");this.url=o.url,this.credentials=o.credentials,a.headers||(this.headers=new p(o.headers)),this.method=o.method,this.mode=o.mode,this.signal=o.signal,!f&&o._bodyInit!=null&&(f=o._bodyInit,o.bodyUsed=!0)}else this.url=String(o);if(this.credentials=a.credentials||this.credentials||"same-origin",(a.headers||!this.headers)&&(this.headers=new p(a.headers)),this.method=se(a.method||this.method||"GET"),this.mode=a.mode||this.mode||null,this.signal=a.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&f)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(f)}O.prototype.clone=function(){return new O(this,{body:this._bodyInit})};function ie(o){var a=new FormData;return o.trim().split("&").forEach(function(f){if(f){var d=f.split("="),l=d.shift().replace(/\+/g," "),h=d.join("=").replace(/\+/g," ");a.append(decodeURIComponent(l),decodeURIComponent(h))}}),a}function ae(o){var a=new p,f=o.replace(/\r?\n[\t ]+/g," ");return f.split(/\r?\n/).forEach(function(d){var l=d.split(":"),h=l.shift().trim();if(h){var J=l.join(":").trim();a.append(h,J)}}),a}Q.call(O.prototype);function w(o,a){a||(a={}),this.type="default",this.status=a.status===void 0?200:a.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in a?a.statusText:"OK",this.headers=new p(a.headers),this.url=a.url||"",this._initBody(o)}Q.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},w.error=function(){var o=new w(null,{status:0,statusText:""});return o.type="error",o};var oe=[301,302,303,307,308];w.redirect=function(o,a){if(oe.indexOf(a)===-1)throw new RangeError("Invalid status code");return new w(null,{status:a,headers:{location:o}})},c.DOMException=i.DOMException;try{new c.DOMException}catch{c.DOMException=function(a,f){this.message=a,this.name=f;var d=Error(a);this.stack=d.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function z(o,a){return new Promise(function(f,d){var l=new O(o,a);if(l.signal&&l.signal.aborted)return d(new c.DOMException("Aborted","AbortError"));var h=new XMLHttpRequest;function J(){h.abort()}h.onload=function(){var F={status:h.status,statusText:h.statusText,headers:ae(h.getAllResponseHeaders()||"")};F.url="responseURL"in h?h.responseURL:F.headers.get("X-Request-URL");var ce="response"in h?h.response:h.responseText;f(new w(ce,F))},h.onerror=function(){d(new TypeError("Network request failed"))},h.ontimeout=function(){d(new TypeError("Network request failed"))},h.onabort=function(){d(new c.DOMException("Aborted","AbortError"))},h.open(l.method,l.url,!0),l.credentials==="include"?h.withCredentials=!0:l.credentials==="omit"&&(h.withCredentials=!1),"responseType"in h&&u.blob&&(h.responseType="blob"),l.headers.forEach(function(F,ce){h.setRequestHeader(ce,F)}),l.signal&&(l.signal.addEventListener("abort",J),h.onreadystatechange=function(){h.readyState===4&&l.signal.removeEventListener("abort",J)}),h.send(typeof l._bodyInit>"u"?null:l._bodyInit)})}return z.polyfill=!0,i.fetch||(i.fetch=z,i.Headers=p,i.Request=O,i.Response=w),c.Headers=p,c.Request=O,c.Response=w,c.fetch=z,Object.defineProperty(c,"__esModule",{value:!0}),c})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=r;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t})(le,le.exports);var yt=le.exports,pt=P&&P.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function u(m){try{E(r.next(m))}catch(y){c(y)}}function g(m){try{E(r.throw(m))}catch(y){c(y)}}function E(m){m.done?i(m.value):s(m.value).then(u,g)}E((r=r.apply(e,t||[])).next())})},mt=P&&P.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(D,"__esModule",{value:!0});D.fetchData=D.stringifyQuery=D.insertParams=void 0;const bt=mt(yt),Et=e=>typeof e=="object"&&e!==null&&"code"in e&&"message"in e;function At(e,t,n){return e.replace(new RegExp(`\\{${t}\\}`,"g"),n)}function Tt(e,t){return t?Object.keys(t).reduce((n,r)=>At(n,r,String(t[r])),e):e}D.insertParams=Tt;function _t(e){if(!e)return"";const t=new URLSearchParams;Object.keys(e).forEach(r=>{e[r]!=null&&t.append(r,String(e[r]))});const n=t.toString();return n?`?${n}`:""}D.stringifyQuery=_t;function wt(e,t){return pt(this,void 0,void 0,function*(){let n;t!=null&&(n={method:"POST",body:typeof t=="string"?t:JSON.stringify(t),headers:{"Content-Type":"application/json"}});const r=yield(0,bt.default)(e,n);let s;try{s=yield r.json()}catch{if(r.headers&&r.headers.get("content-length")!=="0")throw new Error(`Invalid response content: ${r.statusText}`)}if(!r.ok){const i=Et(s)?`${s.code}: ${s.message}`:r.statusText;throw new Error(i)}return s})}D.fetchData=wt;Object.defineProperty(U,"__esModule",{value:!0});U.getEndpoint=U.postEndpoint=void 0;const q=D;function Pe(e,t,n,r){const s=(0,q.insertParams)(t,n),i=(0,q.stringifyQuery)(r);return`${e}${s}${i}`}function St(e,t,n){const r=Pe(e,t,n==null?void 0:n.path,n==null?void 0:n.query);return(0,q.fetchData)(r,n==null?void 0:n.body)}U.postEndpoint=St;function It(e,t,n,r){if(r)return(0,q.fetchData)(r);const s=Pe(e,t,n==null?void 0:n.path,n==null?void 0:n.query);return(0,q.fetchData)(s)}U.getEndpoint=It;var ee={};Object.defineProperty(ee,"__esModule",{value:!0});ee.DEFAULT_BASE_URL=void 0;ee.DEFAULT_BASE_URL="https://safe-client.safe.global";var Ce={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ImplementationVersionState=void 0,function(t){t.UP_TO_DATE="UP_TO_DATE",t.OUTDATED="OUTDATED",t.UNKNOWN="UNKNOWN"}(e.ImplementationVersionState||(e.ImplementationVersionState={}))})(Ce);var De={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeAppSocialPlatforms=e.SafeAppFeatures=e.SafeAppAccessPolicyTypes=void 0,function(t){t.NoRestrictions="NO_RESTRICTIONS",t.DomainAllowlist="DOMAIN_ALLOWLIST"}(e.SafeAppAccessPolicyTypes||(e.SafeAppAccessPolicyTypes={})),function(t){t.BATCHED_TRANSACTIONS="BATCHED_TRANSACTIONS"}(e.SafeAppFeatures||(e.SafeAppFeatures={})),function(t){t.TWITTER="TWITTER",t.GITHUB="GITHUB",t.DISCORD="DISCORD"}(e.SafeAppSocialPlatforms||(e.SafeAppSocialPlatforms={}))})(De);var Be={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LabelValue=e.DetailedExecutionInfoType=e.TransactionListItemType=e.ConflictType=e.TransactionInfoType=e.SettingsInfoType=e.TransactionTokenType=e.TransferDirection=e.TransactionStatus=e.Operation=void 0,function(t){t[t.CALL=0]="CALL",t[t.DELEGATE=1]="DELEGATE"}(e.Operation||(e.Operation={})),function(t){t.AWAITING_CONFIRMATIONS="AWAITING_CONFIRMATIONS",t.AWAITING_EXECUTION="AWAITING_EXECUTION",t.CANCELLED="CANCELLED",t.FAILED="FAILED",t.SUCCESS="SUCCESS"}(e.TransactionStatus||(e.TransactionStatus={})),function(t){t.INCOMING="INCOMING",t.OUTGOING="OUTGOING",t.UNKNOWN="UNKNOWN"}(e.TransferDirection||(e.TransferDirection={})),function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_COIN="NATIVE_COIN"}(e.TransactionTokenType||(e.TransactionTokenType={})),function(t){t.SET_FALLBACK_HANDLER="SET_FALLBACK_HANDLER",t.ADD_OWNER="ADD_OWNER",t.REMOVE_OWNER="REMOVE_OWNER",t.SWAP_OWNER="SWAP_OWNER",t.CHANGE_THRESHOLD="CHANGE_THRESHOLD",t.CHANGE_IMPLEMENTATION="CHANGE_IMPLEMENTATION",t.ENABLE_MODULE="ENABLE_MODULE",t.DISABLE_MODULE="DISABLE_MODULE",t.SET_GUARD="SET_GUARD",t.DELETE_GUARD="DELETE_GUARD"}(e.SettingsInfoType||(e.SettingsInfoType={})),function(t){t.TRANSFER="Transfer",t.SETTINGS_CHANGE="SettingsChange",t.CUSTOM="Custom",t.CREATION="Creation"}(e.TransactionInfoType||(e.TransactionInfoType={})),function(t){t.NONE="None",t.HAS_NEXT="HasNext",t.END="End"}(e.ConflictType||(e.ConflictType={})),function(t){t.TRANSACTION="TRANSACTION",t.LABEL="LABEL",t.CONFLICT_HEADER="CONFLICT_HEADER",t.DATE_LABEL="DATE_LABEL"}(e.TransactionListItemType||(e.TransactionListItemType={})),function(t){t.MULTISIG="MULTISIG",t.MODULE="MODULE"}(e.DetailedExecutionInfoType||(e.DetailedExecutionInfoType={})),function(t){t.Queued="Queued",t.Next="Next"}(e.LabelValue||(e.LabelValue={}))})(Be);var Me={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FEATURES=e.GAS_PRICE_TYPE=e.RPC_AUTHENTICATION=void 0,function(t){t.API_KEY_PATH="API_KEY_PATH",t.NO_AUTHENTICATION="NO_AUTHENTICATION",t.UNKNOWN="UNKNOWN"}(e.RPC_AUTHENTICATION||(e.RPC_AUTHENTICATION={})),function(t){t.ORACLE="ORACLE",t.FIXED="FIXED",t.FIXED_1559="FIXED1559",t.UNKNOWN="UNKNOWN"}(e.GAS_PRICE_TYPE||(e.GAS_PRICE_TYPE={})),function(t){t.ERC721="ERC721",t.SAFE_APPS="SAFE_APPS",t.CONTRACT_INTERACTION="CONTRACT_INTERACTION",t.DOMAIN_LOOKUP="DOMAIN_LOOKUP",t.SPENDING_LIMIT="SPENDING_LIMIT",t.EIP1559="EIP1559",t.SAFE_TX_GAS_OPTIONAL="SAFE_TX_GAS_OPTIONAL",t.TX_SIMULATION="TX_SIMULATION",t.EIP1271="EIP1271"}(e.FEATURES||(e.FEATURES={}))})(Me);var Re={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TokenType=void 0,function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_TOKEN="NATIVE_TOKEN"}(e.TokenType||(e.TokenType={}))})(Re);var $e={};Object.defineProperty($e,"__esModule",{value:!0});var Le={};Object.defineProperty(Le,"__esModule",{value:!0});var Ue={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeMessageStatus=e.SafeMessageListItemType=void 0,function(t){t.DATE_LABEL="DATE_LABEL",t.MESSAGE="MESSAGE"}(e.SafeMessageListItemType||(e.SafeMessageListItemType={})),function(t){t.NEEDS_CONFIRMATION="NEEDS_CONFIRMATION",t.CONFIRMED="CONFIRMED"}(e.SafeMessageStatus||(e.SafeMessageStatus={}))})(Ue);(function(e){var t=P&&P.__createBinding||(Object.create?function(a,f,d,l){l===void 0&&(l=d);var h=Object.getOwnPropertyDescriptor(f,d);(!h||("get"in h?!f.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return f[d]}}),Object.defineProperty(a,l,h)}:function(a,f,d,l){l===void 0&&(l=d),a[l]=f[d]}),n=P&&P.__exportStar||function(a,f){for(var d in a)d!=="default"&&!Object.prototype.hasOwnProperty.call(f,d)&&t(f,a,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.getDelegates=e.confirmSafeMessage=e.proposeSafeMessage=e.getSafeMessage=e.getSafeMessages=e.getDecodedData=e.getMasterCopies=e.getSafeApps=e.getChainConfig=e.getChainsConfig=e.proposeTransaction=e.postSafeGasEstimation=e.getTransactionDetails=e.getTransactionQueue=e.getTransactionHistory=e.getCollectiblesPage=e.getCollectibles=e.getOwnedSafes=e.getFiatCurrencies=e.getBalances=e.getMultisigTransactions=e.getModuleTransactions=e.getIncomingTransfers=e.getSafeInfo=e.setBaseUrl=void 0;const r=U,s=ee;n(Ce,e),n(De,e),n(Be,e),n(Me,e),n(Re,e),n($e,e),n(Le,e),n(Ue,e);let i=s.DEFAULT_BASE_URL;const c=a=>{i=a};e.setBaseUrl=c;function u(a,f){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}",{path:{chainId:a,address:f}})}e.getSafeInfo=u;function g(a,f,d,l){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/incoming-transfers/",{path:{chainId:a,address:f},query:d},l)}e.getIncomingTransfers=g;function E(a,f,d,l){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/module-transactions/",{path:{chainId:a,address:f},query:d},l)}e.getModuleTransactions=E;function m(a,f,d,l){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/multisig-transactions/",{path:{chainId:a,address:f},query:d},l)}e.getMultisigTransactions=m;function y(a,f,d="usd",l={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/balances/{currency}",{path:{chainId:a,address:f,currency:d},query:l})}e.getBalances=y;function $(){return(0,r.getEndpoint)(i,"/v1/balances/supported-fiat-codes")}e.getFiatCurrencies=$;function C(a,f){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/owners/{address}/safes",{path:{chainId:a,address:f}})}e.getOwnedSafes=C;function p(a,f,d={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:f},query:d})}e.getCollectibles=p;function L(a,f,d={},l){return(0,r.getEndpoint)(i,"/v2/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:f},query:d},l)}e.getCollectiblesPage=L;function S(a,f,d){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/transactions/history",{path:{chainId:a,safe_address:f},query:{}},d)}e.getTransactionHistory=S;function j(a,f,d,l){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/transactions/queued",{path:{chainId:a,safe_address:f},query:{trusted:l}},d)}e.getTransactionQueue=j;function te(a,f){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/transactions/{transactionId}",{path:{chainId:a,transactionId:f}})}e.getTransactionDetails=te;function ne(a,f,d){return(0,r.postEndpoint)(i,"/v2/chains/{chainId}/safes/{safe_address}/multisig-transactions/estimations",{path:{chainId:a,safe_address:f},body:d})}e.postSafeGasEstimation=ne;function X(a,f,d){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/transactions/{safe_address}/propose",{path:{chainId:a,safe_address:f},body:d})}e.proposeTransaction=X;function Q(a){return(0,r.getEndpoint)(i,"/v1/chains",{query:a})}e.getChainsConfig=Q;function re(a){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}",{path:{chainId:a}})}e.getChainConfig=re;function se(a,f={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safe-apps",{path:{chainId:a},query:f})}e.getSafeApps=se;function O(a){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/about/master-copies",{path:{chainId:a}})}e.getMasterCopies=O;function ie(a,f,d){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/data-decoder",{path:{chainId:a},body:{data:f,to:d}})}e.getDecodedData=ie;function ae(a,f,d){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:f},query:{}},d)}e.getSafeMessages=ae;function w(a,f){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/messages/{message_hash}",{path:{chainId:a,message_hash:f}})}e.getSafeMessage=w;function oe(a,f,d){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:f},body:d})}e.proposeSafeMessage=oe;function z(a,f,d){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/messages/{message_hash}/signatures",{path:{chainId:a,message_hash:f},body:d})}e.confirmSafeMessage=z;function o(a,f={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/delegates",{path:{chainId:a},query:f})}e.getDelegates=o})(gt);class Ot{constructor(t){this.communicator=t}async getBySafeTxHash(t){if(!t)throw new Error("Invalid safeTxHash");return(await this.communicator.send(A.getTxBySafeTxHash,{safeTxHash:t})).data}async signMessage(t){const n={message:t};return(await this.communicator.send(A.signMessage,n)).data}async signTypedMessage(t){if(!Ne(t))throw new Error("Invalid typed data");return(await this.communicator.send(A.signTypedMessage,{typedData:t})).data}async send({txs:t,params:n}){if(!t||!t.length)throw new Error("No transactions were passed");const r={txs:t,params:n};return(await this.communicator.send(A.sendTransactions,r)).data}}const T={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"},v={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};class vt{constructor(t){this.communicator=t,this.call=this.buildRequest({call:T.eth_call,formatters:[null,v.defaultBlockParam]}),this.getBalance=this.buildRequest({call:T.eth_getBalance,formatters:[null,v.defaultBlockParam]}),this.getCode=this.buildRequest({call:T.eth_getCode,formatters:[null,v.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:T.eth_getStorageAt,formatters:[null,v.blockNumberToHex,v.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:T.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:T.eth_getBlockByHash,formatters:[null,v.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:T.eth_getBlockByNumber,formatters:[v.blockNumberToHex,v.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:T.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:T.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:T.eth_getTransactionCount,formatters:[null,v.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:T.eth_gasPrice}),this.getEstimateGas=n=>this.buildRequest({call:T.eth_estimateGas})([n]),this.setSafeSettings=this.buildRequest({call:T.safe_setSettings})}buildRequest(t){const{call:n,formatters:r}=t;return async s=>{r&&Array.isArray(s)&&r.forEach((u,g)=>{u&&(s[g]=u(s[g]))});const i={call:n,params:s||[]};return(await this.communicator.send(A.rpcCall,i)).data}}}function Nt(e,t){const n=e.exec(t);return n==null?void 0:n.groups}const _e=/^tuple(?<array>(\[(\d*)\])*)$/;function he(e){let t=e.type;if(_e.test(e.type)&&"components"in e){t="(";const n=e.components.length;for(let s=0;s<n;s++){const i=e.components[s];t+=he(i),s<n-1&&(t+=", ")}const r=Nt(_e,e.type);return t+=`)${(r==null?void 0:r.array)??""}`,he({...e,type:t})}return"indexed"in e&&e.indexed&&(t=`${t} indexed`),e.name?`${t} ${e.name}`:t}function k(e){let t="";const n=e.length;for(let r=0;r<n;r++){const s=e[r];t+=he(s),r!==n-1&&(t+=", ")}return t}function Pt(e){return e.type==="function"?`function ${e.name}(${k(e.inputs)})${e.stateMutability&&e.stateMutability!=="nonpayable"?` ${e.stateMutability}`:""}${e.outputs.length?` returns (${k(e.outputs)})`:""}`:e.type==="event"?`event ${e.name}(${k(e.inputs)})`:e.type==="error"?`error ${e.name}(${k(e.inputs)})`:e.type==="constructor"?`constructor(${k(e.inputs)})${e.stateMutability==="payable"?" payable":""}`:e.type==="fallback"?"fallback()":"receive() external payable"}function ge(e,{includeName:t=!1}={}){if(e.type!=="function"&&e.type!=="event"&&e.type!=="error")throw new Ht(e.type);return`${e.name}(${He(e.inputs,{includeName:t})})`}function He(e,{includeName:t=!1}={}){return e?e.map(n=>Ct(n,{includeName:t})).join(t?", ":","):""}function Ct(e,{includeName:t}){return e.type.startsWith("tuple")?`(${He(e.components,{includeName:t})})${e.type.slice(5)}`:e.type+(t&&e.name?` ${e.name}`:"")}function W(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function _(e){return W(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const je="2.21.43";let G={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?`#${n}`:""}`:void 0,version:`viem@${je}`};class b extends Error{constructor(t,n={}){var u;const r=(()=>{var g;return n.cause instanceof b?n.cause.details:(g=n.cause)!=null&&g.message?n.cause.message:n.details})(),s=n.cause instanceof b&&n.cause.docsPath||n.docsPath,i=(u=G.getDocsUrl)==null?void 0:u.call(G,{...n,docsPath:s}),c=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...G.version?[`Version: ${G.version}`]:[]].join(`
`);super(c,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=t,this.version=je}walk(t){return ze(this,t)}}function ze(e,t){return t!=null&&t(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause!==void 0?ze(e.cause,t):t?null:e}class Dt extends b{constructor({expectedLength:t,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${t}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class Bt extends b{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${_(n)}) does not match expected size (bytes${t}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class Mt extends b{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class we extends b{constructor(t,{docsPath:n}={}){super([`Function ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class Rt extends b{constructor(t,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${t.type}\` in \`${ge(t.abiItem)}\`, and`,`\`${n.type}\` in \`${ge(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class $t extends b{constructor({expectedSize:t,givenSize:n}){super(`Expected bytes${t}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class Lt extends b{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class Ut extends b{constructor(t){super([`Value "${t}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class Ht extends b{constructor(t){super([`"${t}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class Fe extends b{constructor({offset:t,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}class ke extends b{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function H(e,{dir:t,size:n=32}={}){return typeof e=="string"?B(e,{dir:t,size:n}):jt(e,{dir:t,size:n})}function B(e,{dir:t,size:n=32}={}){if(n===null)return e;const r=e.replace("0x","");if(r.length>n*2)throw new ke({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function jt(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new ke({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=t==="right";r[i?s:n-s-1]=e[i?s:e.length-s-1]}return r}class zt extends b{constructor({max:t,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class Ft extends b{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}function K(e,{size:t}){if(_(e)>t)throw new Ft({givenSize:_(e),maxSize:t})}const kt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function me(e,t={}){return typeof e=="number"||typeof e=="bigint"?R(e,t):typeof e=="string"?Y(e,t):typeof e=="boolean"?Ge(e,t):be(e,t)}function Ge(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(K(n,{size:t.size}),H(n,{size:t.size})):n}function be(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=kt[e[s]];const r=`0x${n}`;return typeof t.size=="number"?(K(r,{size:t.size}),H(r,{dir:"right",size:t.size})):r}function R(e,t={}){const{signed:n,size:r}=t,s=BigInt(e);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const c=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<c){const g=typeof e=="bigint"?"n":"";throw new zt({max:i?`${i}${g}`:void 0,min:`${c}${g}`,signed:n,size:r,value:`${e}${g}`})}const u=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?H(u,{size:r}):u}const Gt=new TextEncoder;function Y(e,t={}){const n=Gt.encode(e);return be(n,t)}const qt=new TextEncoder;function qe(e,t={}){return typeof e=="number"||typeof e=="bigint"?Vt(e,t):typeof e=="boolean"?xt(e,t):W(e)?xe(e,t):Ve(e,t)}function xt(e,t={}){const n=new Uint8Array(1);return n[0]=Number(e),typeof t.size=="number"?(K(n,{size:t.size}),H(n,{size:t.size})):n}const N={zero:48,nine:57,A:65,F:70,a:97,f:102};function Se(e){if(e>=N.zero&&e<=N.nine)return e-N.zero;if(e>=N.A&&e<=N.F)return e-(N.A-10);if(e>=N.a&&e<=N.f)return e-(N.a-10)}function xe(e,t={}){let n=e;t.size&&(K(n,{size:t.size}),n=H(n,{dir:"right",size:t.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let c=0,u=0;c<s;c++){const g=Se(r.charCodeAt(u++)),E=Se(r.charCodeAt(u++));if(g===void 0||E===void 0)throw new b(`Invalid byte sequence ("${r[u-2]}${r[u-1]}" in "${r}").`);i[c]=g*16+E}return i}function Vt(e,t){const n=R(e,t);return xe(n)}function Ve(e,t={}){const n=qt.encode(e);return typeof t.size=="number"?(K(n,{size:t.size}),H(n,{dir:"right",size:t.size})):n}function I(e,t){const n=t||"hex",r=ct(W(e,{strict:!1})?qe(e):e);return n==="bytes"?r:me(r)}const Wt=e=>I(qe(e));function Kt(e){return Wt(e)}function Xt(e){let t=!0,n="",r=0,s="",i=!1;for(let c=0;c<e.length;c++){const u=e[c];if(["(",")",","].includes(u)&&(t=!0),u==="("&&r++,u===")"&&r--,!!t){if(r===0){if(u===" "&&["event","function",""].includes(s))s="";else if(s+=u,u===")"){i=!0;break}continue}if(u===" "){e[c-1]!==","&&n!==","&&n!==",("&&(n="",t=!1);continue}s+=u,n+=u}}if(!i)throw new b("Unable to normalize signature.");return s}const Qt=e=>{const t=typeof e=="string"?e:Pt(e);return Xt(t)};function We(e){return Kt(Qt(e))}const Jt=We;class Ke extends b{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class Xe extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const ue=new Xe(8192);function Yt(e,t){if(ue.has(`${e}.${t}`))return ue.get(`${e}.${t}`);const n=e.substring(2).toLowerCase(),r=I(Ve(n),"bytes"),s=n.split("");for(let c=0;c<40;c+=2)r[c>>1]>>4>=8&&s[c]&&(s[c]=s[c].toUpperCase()),(r[c>>1]&15)>=8&&s[c+1]&&(s[c+1]=s[c+1].toUpperCase());const i=`0x${s.join("")}`;return ue.set(`${e}.${t}`,i),i}const Zt=/^0x[a-fA-F0-9]{40}$/,fe=new Xe(8192);function x(e,t){const{strict:n=!0}=t??{},r=`${e}.${n}`;if(fe.has(r))return fe.get(r);const s=Zt.test(e)?e.toLowerCase()===e?!0:n?Yt(e)===e:!0:!1;return fe.set(r,s),s}function M(e){return typeof e[0]=="string"?Qe(e):en(e)}function en(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return n}function Qe(e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function Je(e,t,n,{strict:r}={}){return W(e,{strict:!1})?nn(e,t,n,{strict:r}):tn(e,t,n,{strict:r})}function Ye(e,t){if(typeof t=="number"&&t>0&&t>_(e)-1)throw new Fe({offset:t,position:"start",size:_(e)})}function Ze(e,t,n){if(typeof t=="number"&&typeof n=="number"&&_(e)!==n-t)throw new Fe({offset:n,position:"end",size:_(e)})}function tn(e,t,n,{strict:r}={}){Ye(e,t);const s=e.slice(t,n);return r&&Ze(s,t,n),s}function nn(e,t,n,{strict:r}={}){Ye(e,t);const s=`0x${e.replace("0x","").slice((t??0)*2,(n??e.length)*2)}`;return r&&Ze(s,t,n),s}function Ee(e,t){if(e.length!==t.length)throw new Mt({expectedLength:e.length,givenLength:t.length});const n=rn({params:e,values:t}),r=Te(n);return r.length===0?"0x":r}function rn({params:e,values:t}){const n=[];for(let r=0;r<e.length;r++)n.push(Ae({param:e[r],value:t[r]}));return n}function Ae({param:e,value:t}){const n=ln(e.type);if(n){const[r,s]=n;return an(t,{length:r,param:{...e,type:s}})}if(e.type==="tuple")return dn(t,{param:e});if(e.type==="address")return sn(t);if(e.type==="bool")return cn(t);if(e.type.startsWith("uint")||e.type.startsWith("int")){const r=e.type.startsWith("int");return un(t,{signed:r})}if(e.type.startsWith("bytes"))return on(t,{param:e});if(e.type==="string")return fn(t);throw new Lt(e.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function Te(e){let t=0;for(let i=0;i<e.length;i++){const{dynamic:c,encoded:u}=e[i];c?t+=32:t+=_(u)}const n=[],r=[];let s=0;for(let i=0;i<e.length;i++){const{dynamic:c,encoded:u}=e[i];c?(n.push(R(t+s,{size:32})),r.push(u),s+=_(u)):n.push(u)}return M([...n,...r])}function sn(e){if(!x(e))throw new Ke({address:e});return{dynamic:!1,encoded:B(e.toLowerCase())}}function an(e,{length:t,param:n}){const r=t===null;if(!Array.isArray(e))throw new Ut(e);if(!r&&e.length!==t)throw new Dt({expectedLength:t,givenLength:e.length,type:`${n.type}[${t}]`});let s=!1;const i=[];for(let c=0;c<e.length;c++){const u=Ae({param:n,value:e[c]});u.dynamic&&(s=!0),i.push(u)}if(r||s){const c=Te(i);if(r){const u=R(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?M([u,c]):u}}if(s)return{dynamic:!0,encoded:c}}return{dynamic:!1,encoded:M(i.map(({encoded:c})=>c))}}function on(e,{param:t}){const[,n]=t.type.split("bytes"),r=_(e);if(!n){let s=e;return r%32!==0&&(s=B(s,{dir:"right",size:Math.ceil((e.length-2)/2/32)*32})),{dynamic:!0,encoded:M([B(R(r,{size:32})),s])}}if(r!==Number.parseInt(n))throw new Bt({expectedSize:Number.parseInt(n),value:e});return{dynamic:!1,encoded:B(e,{dir:"right"})}}function cn(e){if(typeof e!="boolean")throw new b(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:B(Ge(e))}}function un(e,{signed:t}){return{dynamic:!1,encoded:R(e,{size:32,signed:t})}}function fn(e){const t=Y(e),n=Math.ceil(_(t)/32),r=[];for(let s=0;s<n;s++)r.push(B(Je(t,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:M([B(R(_(t),{size:32})),...r])}}function dn(e,{param:t}){let n=!1;const r=[];for(let s=0;s<t.components.length;s++){const i=t.components[s],c=Array.isArray(e)?s:i.name,u=Ae({param:i,value:e[c]});r.push(u),u.dynamic&&(n=!0)}return{dynamic:n,encoded:n?Te(r):M(r.map(({encoded:s})=>s))}}function ln(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}const et=e=>Je(We(e),0,4);function hn(e){const{abi:t,args:n=[],name:r}=e,s=W(r,{strict:!1}),i=t.filter(u=>s?u.type==="function"?et(u)===r:u.type==="event"?Jt(u)===r:!1:"name"in u&&u.name===r);if(i.length===0)return;if(i.length===1)return i[0];let c;for(const u of i){if(!("inputs"in u))continue;if(!n||n.length===0){if(!u.inputs||u.inputs.length===0)return u;continue}if(!u.inputs||u.inputs.length===0||u.inputs.length!==n.length)continue;if(n.every((E,m)=>{const y="inputs"in u&&u.inputs[m];return y?ye(E,y):!1})){if(c&&"inputs"in c&&c.inputs){const E=tt(u.inputs,c.inputs,n);if(E)throw new Rt({abiItem:u,type:E[0]},{abiItem:c,type:E[1]})}c=u}}return c||i[0]}function ye(e,t){const n=typeof e,r=t.type;switch(r){case"address":return x(e,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in t?Object.values(t.components).every((s,i)=>ye(Object.values(e)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||e instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(e)&&e.every(s=>ye(s,{...t,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function tt(e,t,n){for(const r in e){const s=e[r],i=t[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return tt(s.components,i.components,n[r]);const c=[s.type,i.type];if(c.includes("address")&&c.includes("bytes20")?!0:c.includes("address")&&c.includes("string")?x(n[r],{strict:!1}):c.includes("address")&&c.includes("bytes")?x(n[r],{strict:!1}):!1)return c}}const Ie="/docs/contract/encodeFunctionData";function gn(e){const{abi:t,args:n,functionName:r}=e;let s=t[0];if(r){const i=hn({abi:t,args:n,name:r});if(!i)throw new we(r,{docsPath:Ie});s=i}if(s.type!=="function")throw new we(void 0,{docsPath:Ie});return{abi:[s],functionName:et(ge(s))}}function Oe(e){const{args:t}=e,{abi:n,functionName:r}=(()=>{var u;return e.abi.length===1&&((u=e.functionName)!=null&&u.startsWith("0x"))?e:gn(e)})(),s=n[0],i=r,c="inputs"in s&&s.inputs?Ee(s.inputs,t??[]):void 0;return Qe([i,c??"0x"])}const yn=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,pn=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;class mn extends b{constructor({primaryType:t,types:n}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class bn extends b{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function En(e){const{domain:t={},message:n,primaryType:r}=e,s={EIP712Domain:Sn({domain:t}),...e.types};wn({domain:t,message:n,primaryType:r,types:s});const i=["0x1901"];return t&&i.push(An({domain:t,types:s})),r!=="EIP712Domain"&&i.push(nt({data:n,primaryType:r,types:s})),I(M(i))}function An({domain:e,types:t}){return nt({data:e,primaryType:"EIP712Domain",types:t})}function nt({data:e,primaryType:t,types:n}){const r=rt({data:e,primaryType:t,types:n});return I(r)}function rt({data:e,primaryType:t,types:n}){const r=[{type:"bytes32"}],s=[Tn({primaryType:t,types:n})];for(const i of n[t]){const[c,u]=it({types:n,name:i.name,type:i.type,value:e[i.name]});r.push(c),s.push(u)}return Ee(r,s)}function Tn({primaryType:e,types:t}){const n=me(_n({primaryType:e,types:t}));return I(n)}function _n({primaryType:e,types:t}){let n="";const r=st({primaryType:e,types:t});r.delete(e);const s=[e,...Array.from(r).sort()];for(const i of s)n+=`${i}(${t[i].map(({name:c,type:u})=>`${u} ${c}`).join(",")})`;return n}function st({primaryType:e,types:t},n=new Set){const r=e.match(/^\w*/u),s=r==null?void 0:r[0];if(n.has(s)||t[s]===void 0)return n;n.add(s);for(const i of t[s])st({primaryType:i.type,types:t},n);return n}function it({types:e,name:t,type:n,value:r}){if(e[n]!==void 0)return[{type:"bytes32"},I(rt({data:r,primaryType:n,types:e}))];if(n==="bytes")return r=`0x${(r.length%2?"0":"")+r.slice(2)}`,[{type:"bytes32"},I(r)];if(n==="string")return[{type:"bytes32"},I(me(r))];if(n.lastIndexOf("]")===n.length-1){const s=n.slice(0,n.lastIndexOf("[")),i=r.map(c=>it({name:t,type:s,types:e,value:c}));return[{type:"bytes32"},I(Ee(i.map(([c])=>c),i.map(([,c])=>c)))]}return[{type:n},r]}function wn(e){const{domain:t,message:n,primaryType:r,types:s}=e,i=(c,u)=>{for(const g of c){const{name:E,type:m}=g,y=u[E],$=m.match(pn);if($&&(typeof y=="number"||typeof y=="bigint")){const[L,S,j]=$;R(y,{signed:S==="int",size:Number.parseInt(j)/8})}if(m==="address"&&typeof y=="string"&&!x(y))throw new Ke({address:y});const C=m.match(yn);if(C){const[L,S]=C;if(S&&_(y)!==Number.parseInt(S))throw new $t({expectedSize:Number.parseInt(S),givenSize:_(y)})}const p=s[m];p&&(In(m),i(p,y))}};if(s.EIP712Domain&&t&&i(s.EIP712Domain,t),r!=="EIP712Domain")if(s[r])i(s[r],n);else throw new mn({primaryType:r,types:s})}function Sn({domain:e}){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},typeof(e==null?void 0:e.chainId)=="number"&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}function In(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new bn({type:e})}const On=`Ethereum Signed Message:
`;function vn(e){const t=typeof e=="string"?Y(e):typeof e.raw=="string"?e.raw:be(e.raw),n=Y(`${On}${_(t)}`);return M([n,t])}function Nn(e,t){return I(vn(e),t)}const Pn="0x1626ba7e",Cn="0x20c13b0b",pe=4001;class V extends Error{constructor(t,n,r){super(t),this.code=n,this.data=r,Object.setPrototypeOf(this,V.prototype)}}class at{constructor(t){this.communicator=t}async getPermissions(){return(await this.communicator.send(A.wallet_getPermissions,void 0)).data}async requestPermissions(t){if(!this.isPermissionRequestValid(t))throw new V("Permissions request is invalid",pe);try{return(await this.communicator.send(A.wallet_requestPermissions,t)).data}catch{throw new V("Permissions rejected",pe)}}isPermissionRequestValid(t){return t.every(n=>typeof n=="object"?Object.keys(n).every(r=>!!Object.values(de).includes(r)):!1)}}const ve=(e,t)=>t.some(n=>n.parentCapability===e),Dn=()=>(e,t,n)=>{const r=n.value;return n.value=async function(){const s=new at(this.communicator);let i=await s.getPermissions();if(ve(t,i)||(i=await s.requestPermissions([{[t]:{}}])),!ve(t,i))throw new V("Permissions rejected",pe);return r.apply(this)},n};var Bn=function(e,t,n,r){var s=arguments.length,i=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(i=(s<3?c(i):s>3?c(t,n,i):c(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i};class ot{constructor(t){this.communicator=t}async getChainInfo(){return(await this.communicator.send(A.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(A.getSafeInfo,void 0)).data}async experimental_getBalances({currency:t="usd"}={}){return(await this.communicator.send(A.getSafeBalances,{currency:t})).data}async check1271Signature(t,n="0x"){const r=await this.getInfo(),s=Oe({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),i={call:T.eth_call,params:[{to:r.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(A.rpcCall,i)).data.slice(0,10).toLowerCase()===Pn}catch{return!1}}async check1271SignatureBytes(t,n="0x"){const r=await this.getInfo(),s=Oe({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),i={call:T.eth_call,params:[{to:r.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(A.rpcCall,i)).data.slice(0,10).toLowerCase()===Cn}catch{return!1}}calculateMessageHash(t){return Nn(t)}calculateTypedMessageHash(t){const n=typeof t.domain.chainId=="object"?t.domain.chainId.toNumber():Number(t.domain.chainId);let r=t.primaryType;if(!r){const s=Object.values(t.types),i=Object.keys(t.types).filter(c=>s.every(u=>u.every(({type:g})=>g.replace("[","").replace("]","")!==c)));if(i.length===0||i.length>1)throw new Error("Please specify primaryType");r=i[0]}return En({message:t.message,domain:{...t.domain,chainId:n,verifyingContract:t.domain.verifyingContract,salt:t.domain.salt},types:t.types,primaryType:r})}async getOffChainSignature(t){return(await this.communicator.send(A.getOffChainSignature,t)).data}async isMessageSigned(t,n="0x"){let r;if(typeof t=="string"&&(r=async()=>{const s=this.calculateMessageHash(t);return await this.isMessageHashSigned(s,n)}),Ne(t)&&(r=async()=>{const s=this.calculateTypedMessageHash(t);return await this.isMessageHashSigned(s,n)}),r)return await r();throw new Error("Invalid message type")}async isMessageHashSigned(t,n="0x"){const r=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const s of r)if(await s(t,n))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(A.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(A.requestAddressBook,void 0)).data}}Bn([Dn()],ot.prototype,"requestAddressBook",null);class Mn{constructor(t={}){const{allowedDomains:n=null,debug:r=!1}=t;this.communicator=new ht(n,r),this.eth=new vt(this.communicator),this.txs=new Ot(this.communicator),this.safe=new ot(this.communicator),this.wallet=new at(this.communicator)}}const Ln=Mn;export{Z as MessageFormatter,A as Methods,T as RPC_CALLS,de as RestrictedMethods,Ln as default,ut as getSDKVersion,Ne as isObjectEIP712TypedData};
//# sourceMappingURL=index-DW7lg4QJ.js.map
